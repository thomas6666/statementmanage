!function($){$.fn.calculator=function(t){var e=jQuery.extend({},$.fn.calculator.defaults,t);return this.each(function(){var t=$(this);t.hasClass("converted2calc")||(t.settings=$.meta?$.extend({},e,t.data()):e,$.fn.calculator.init(t),t.addClass("converted2calc"),$(".calc-button").hover(function(){$(this).addClass("calc-btn-hover")},function(){$(this).removeClass("calc-btn-hover")}))})},$.fn.calculator.init=function(t){t.expression="",t.text="0",t._cleartextflag=!1,t._executable=!0,t._lastresult=null,$.fn.calculator.format(t).find(".calc-title-bar").text(t.settings.title);for(i in $.fn.calculator.buttons)$.fn.calculator.format.addButton(t,$.fn.calculator.buttons[i]);t.keydown(function(e){e.preventDefault(),$.fn.calculator.buttons[e.keyCode]&&($.fn.calculator.buttons[e.keyCode].onPress(t),$.fn.calculator.action.updateDisplay(t),t.settings.buttonPressed())}),t.settings.defaultOpen?"":t.css({display:"none"}),t.settings.movable&&$.fn.draggable?t.draggable({handle:".calc-title-bar-container"}).find(".calc-title-bar-container").css("cursor","move"):"",t.settings.movable?$('<div class="calc-title-bar-button-close"></div>').button({icons:{primary:"ui-icon-close"},text:!1}).appendTo(t.find(".calc-title-bar-container")).css({position:"absolute",right:2,top:2,width:15,height:14}).click(function(){t.settings.hide(t)}):"",t.settings.resizable&&$.fn.resizable?t.resizable({handles:"se"}).css({minHeight:160,minWidth:130}):"",$.fn.calculator.action.updateDisplay(t)},$.fn.calculator.hide=function(t){t.hide()},$.fn.calculator.show=function(t){t.show()},$.fn.calculator.format=function(t){return t.addClass("calculator calc-wrapper ui-widget ui-corner-all ui-widget-content").html('<div class="calc-title-bar-container ui-widget-header" style="height:20px;left:0;position:absolute;right:0;top:0;"><div class="calc-title-bar" style="padding:2px 3px;"></div></div><div class="calc-container" style="position:absolute;left:2px;right:2px;top:24px;bottom:2px"><div class="calc-text-wrapper" style="height:20%;left:3px;position:absolute;right:0;top:3%;"><label class="calc-text" style="background:#fff;border:1px solid #CCC;bottom:0;left:4%;overflow:hidden;padding:2px;position:absolute;right:4%;top:0px;text-align:right;vertical-align:middle;height:48px;"></label></div><div class="calc-buttons-wrapper" style="bottom:4px;left:2px;position:absolute;right:2px;top:23%;"></div></div>').attr("tabindex",0).css({width:t.settings.width,height:t.settings.height,outline:"none",position:"relative",zIndex:99999}).focusin(function(){t.find(".calc-text").css({backgroundColor:"#FFFFF2"})}).focusout(function(){t.find(".calc-text").css({backgroundColor:""})})},$.fn.calculator.format.createButton=function(t){var e=t.left?"left:"+t.left+";":"";return e+=t.top?"top:"+t.top+";":"",e+=t.width?"width:"+t.width+";":"",e+=t.height?"height:"+t.height+";":"",$('<div class="calc-button-wrapper" style="position:absolute;'+e+'"><div class="calc-button" style="left:0;right:0;bottom:0;position:absolute;text-align:center;text-decoration:none;top:0;">'+t.symbol+"</div></div>")},$.fn.calculator.format.addButton=function(t,e){$.fn.calculator.format.createButton(e).button().appendTo(t.find(".calc-buttons-wrapper")).click(function(){e.onPress(t),$.fn.calculator.action.updateDisplay(t),t.settings.buttonPressed()})},$.fn.calculator.action={updateDisplay:function(t){t.find(".calc-text").text(t.text),t.settings.displayChanged()},input:function(calc,button){if(calc._executable){if(calc.text.length<calc.settings.accuracy||calc._cleartextflag){var input="0"==calc.text||calc._cleartextflag?"."==button.symbol?"0.":"0"==button.symbol?"":button.symbol:calc.text+button.symbol;""==input&&calc.expression.indexOf("*")!==-1&&(input="0"),"0."==input&&calc.expression.indexOf("*0")!==-1&&(calc.expression=calc.expression.substr(0,calc.expression.length-1)),$.fn.calculator.validate.input(input)&&(calc.text=input,calc.expression=calc.expression+("0."==input?input:button.symbol),calc._cleartextflag=!1)}calc._lastresult=null}else $.fn.calculator.validate.expression(calc.expression)&&(calc.text=eval(calc.expression),calc._lastresult=calc.text+"",calc.text=calc.text.toPrecision(calc.settings.accuracy).indexOf("e")==-1?parseFloat(calc.text.toPrecision(calc.settings.accuracy))+"":calc.text.toPrecision(calc.settings.accuracy),calc.expression="",calc._executable=!1,calc._cleartextflag=!0),calc._lastresult&&(calc.expression=calc._lastresult,calc._lastresult=null),calc._cleartextflag=!0,calc.expression=""==calc.expression?"0"+button.symbol:$.fn.calculator.validate.operation(calc.expression)?calc.expression.replace(/[-+\/\*]$/,button.symbol):calc.expression+button.symbol}},$.fn.calculator.buttons={96:{symbol:"0",keycode:48,left:"9px",top:"159px",width:"98px",height:"30px",onPress:function(t){t._executable=!0,$.fn.calculator.action.input(t,this)}},97:{symbol:"1",keycode:49,left:"9px",top:"121px",width:"44px",height:"30px",onPress:function(t){t._executable=!0,$.fn.calculator.action.input(t,this)}},98:{symbol:"2",keycode:50,left:"62px",top:"121px",width:"44px",height:"30px",onPress:function(t){t._executable=!0,$.fn.calculator.action.input(t,this)}},99:{symbol:"3",keycode:51,left:"115px",top:"121px",width:"44px",height:"30px",onPress:function(t){t._executable=!0,$.fn.calculator.action.input(t,this)}},100:{symbol:"4",keycode:52,left:"9px",top:"83px",width:"44px",height:"30px",onPress:function(t){t._executable=!0,$.fn.calculator.action.input(t,this)}},101:{symbol:"5",keycode:53,left:"62px",top:"83px",width:"44px",height:"30px",onPress:function(t){t._executable=!0,$.fn.calculator.action.input(t,this)}},102:{symbol:"6",keycode:54,left:"115px",top:"83px",width:"44px",height:"30px",onPress:function(t){t._executable=!0,$.fn.calculator.action.input(t,this)}},103:{symbol:"7",keycode:55,left:"9px",top:"46px",width:"44px",height:"30px",onPress:function(t){t._executable=!0,$.fn.calculator.action.input(t,this)}},104:{symbol:"8",keycode:56,left:"62px",top:"46px",width:"44px",height:"30px",onPress:function(t){t._executable=!0,$.fn.calculator.action.input(t,this)}},105:{symbol:"9",keycode:57,left:"115px",top:"46px",width:"44px",height:"30px",onPress:function(t){t._executable=!0,$.fn.calculator.action.input(t,this)}},110:{symbol:".",keycode:110,left:"115px",top:"159px",width:"44px",height:"30px",onPress:function(t){t._executable=!0,$.fn.calculator.action.input(t,this)}},111:{symbol:"/",keycode:111,left:"9px",top:"9px",width:"44px",height:"30px",onPress:function(t){t._executable=!1,$.fn.calculator.action.input(t,this)}},106:{symbol:"*",keycode:106,left:"62px",top:"9px",width:"44px",height:"30px",onPress:function(t){t._executable=!1,$.fn.calculator.action.input(t,this)}},107:{symbol:"+",keycode:107,left:"169px",top:"46px",width:"44px",height:"67px",onPress:function(t){t._executable=!1,$.fn.calculator.action.input(t,this)}},109:{symbol:"-",keycode:109,left:"115px",top:"9px",width:"44px",height:"30px",onPress:function(t){t._executable=!1,$.fn.calculator.action.input(t,this)}},13:{symbol:"=",keycode:13,left:"169px",top:"121px",width:"44px",height:"67px",onPress:function(calc){$.fn.calculator.validate.expression(calc.expression)?(calc.text=eval(calc.expression),calc._lastresult=calc.text+"",calc.text=calc.text.toPrecision(calc.settings.accuracy).indexOf("e")==-1?parseFloat(calc.text.toPrecision(calc.settings.accuracy))+"":calc.text.toPrecision(calc.settings.accuracy),calc.expression="",calc._executable=!1,calc._cleartextflag=!0):calc.expression=calc.text}},27:{symbol:"C",keycode:27,left:"169px",top:"9px",width:"44px",height:"30px",onPress:function(t){t._executable=!0,t.expression="",t.text="0",t._lastresult=null}}},$.fn.calculator.validate={input:function(t){return t.match(/^((0|(0\.[0-9]*))|([1-9][0-9]*|([1-9][0-9]*\.[0-9]*)|([1-9][0-9]*\.[0-9]*)|([1-9][0-9]*)))$/)},expression:function(t){return t.match(/^-?\d{1,}(\.\d{1,})?[-+*\/]\d{1,}(\.\d{1,})?$/)},operation:function(t){return t.match(/[-+\/\*]$/)}},$.fn.button||($.fn.button=function(){return button=$(this),this.each(function(){button=$(this),button.find(".calc-button").css({borderWidth:1,borderStyle:"solid",borderColor:"#CCCCCC",lineHeight:1.4,fontSize:"1em",cursor:"pointer",fontWeight:"bold"})})}),$.fn.calculator.defaults={defaultOpen:!0,title:"Calculator",accuracy:12,width:164,height:180,movable:!1,resizable:!1,show:function(t){$.fn.calculator.show(t)},hide:function(t){$.fn.calculator.hide(t)},buttonPressed:function(t,e){},displayChanged:function(t,e,c){}}}(jQuery);